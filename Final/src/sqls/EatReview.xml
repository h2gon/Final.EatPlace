<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="EatReview">
  
  
 <select id="getReviewList" resultType="kh.c.five.model.EATReviewDto">
	SELECT SEQ, ID, REF, STEP, DEPTH, 
				TITLE, CONTENT, WDATE, PARENT, 
				DEL, READCOUNT
				FROM BBS
				ORDER BY REF DESC, STEP ASC
</select>
  
  <select id="getImage" parameterType="java.lang.Integer" resultType="kh.c.five.model.fileDto">
  SELECT FILE_NAME
	FROM RS_FILE 
	WHERE RV_SEQ=#{rs_seq}
  </select>
  
  
  <insert id="addReview" parameterType="kh.c.five.model.ReviewDto" >
  	INSERT INTO RESTAURANT_REVIEW(SEQ, ID, RS_SEQ, RS_CONTENT, RS_RATING)
  	VALUES(REIVEW_SEQ.NEXTVAL, #{id}, #{rs_seq}, #{rs_content}, #{rs_rating})
  	
  	<selectKey resultType="int" keyProperty="seq" order="AFTER">
  		SELECT REIVEW_SEQ.CURRVAL FROM DUAL
  	</selectKey>
  
  </insert>
  
  <insert id="addFile" parameterType="kh.c.five.model.fileDto">
  	
   INSERT INTO RS_FILE (SEQ, O_NAME, FILE_NAME, FILE_SIZE, RV_SEQ, RS_SEQ)
	VALUES(RSFILE_SEQ.NEXTVAL,#{o_name},#{file_name},#{file_size},#{seq},#{rs_seq})
  
  </insert>
  
  </mapper>